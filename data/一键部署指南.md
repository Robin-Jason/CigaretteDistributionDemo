# ä¸€é”®éƒ¨ç½²æŒ‡å—

> **ç›®æ ‡æœåŠ¡å™¨**: 10.69.110.130:50130  
> **éƒ¨ç½²æ—¶é—´**: çº¦15åˆ†é’Ÿï¼ˆé¦–æ¬¡ï¼‰  
> **çŠ¶æ€**: âœ… å·²éªŒè¯ï¼Œå¯ç«‹å³éƒ¨ç½²

---

## ğŸ¯ å¿«é€Ÿéƒ¨ç½²ï¼ˆ3æ­¥ï¼‰

### ç¬¬1æ­¥ï¼šä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨

**åœ¨æœ¬åœ°Macç»ˆç«¯æ‰§è¡Œ**ï¼š

```bash
cd /Users/robin/Desktop/CigaretteDistributionSystem
scp -P 50130 -r data/ root@10.69.110.130:/root/cigarette-distribution-system/
```

**è¾“å…¥å¯†ç **: `SYyc_110.130#`

**é¢„è®¡æ—¶é—´**: 2-3åˆ†é’Ÿï¼ˆä¸Šä¼ 77MBï¼‰

**éªŒè¯ä¸Šä¼ æˆåŠŸ**ï¼š
```bash
# åº”è¯¥çœ‹åˆ°æ–‡ä»¶ä¼ è¾“å®Œæˆï¼Œæ— é”™è¯¯æç¤º
```

---

### ç¬¬2æ­¥ï¼šè¿æ¥åˆ°æœåŠ¡å™¨

```bash
ssh -p 50130 root@10.69.110.130
```

**è¾“å…¥å¯†ç **: `SYyc_110.130#`

---

### ç¬¬3æ­¥ï¼šä¸€é”®éƒ¨ç½²

**åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ**ï¼š

```bash
cd /root/cigarette-system/data
chmod +x deploy.sh
./deploy.sh
```

**è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆ**ï¼š
1. âœ… æ£€æŸ¥Dockerç¯å¢ƒ
2. âœ… æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶ï¼ˆå‰ç«¯+åç«¯+8ä¸ªé…ç½®+SQLï¼‰
3. âœ… åˆ›å»ºæ•°æ®ç›®å½•
4. âœ… å¤åˆ¶åˆå§‹åŒ–SQLåˆ° `/data/mysql/init/`
5. âœ… åˆ›å»ºDockerç½‘ç»œ
6. âœ… åœæ­¢æ—§æœåŠ¡ï¼ˆå¦‚æœ‰ï¼‰
7. âœ… æ„å»ºDockeré•œåƒ
8. âœ… å¯åŠ¨æ‰€æœ‰æœåŠ¡

**é¢„è®¡æ—¶é—´**: 10-15åˆ†é’Ÿ

---

## âœ… éªŒè¯éƒ¨ç½²æˆåŠŸ

### 1. æ£€æŸ¥å®¹å™¨çŠ¶æ€

```bash
docker ps
```

**é¢„æœŸè¾“å‡º**ï¼šåº”è¯¥çœ‹åˆ°3ä¸ªè¿è¡Œä¸­çš„å®¹å™¨

```
CONTAINER ID   IMAGE               STATUS         PORTS                    NAMES
xxxxxxxxx      vue-web             Up X minutes   0.0.0.0:80->80/tcp       vue-web
xxxxxxxxx      springboot-server   Up X minutes   0.0.0.0:28080->28080/tcp springboot-server
xxxxxxxxx      mysql:8.0           Up X minutes   0.0.0.0:3306->3306/tcp   mysql
```

---

### 2. æ£€æŸ¥åç«¯å¥åº·

```bash
curl http://localhost:28080/api/common/health
```

**é¢„æœŸè¿”å›**ï¼š

```json
{
  "status": "UP",
  "message": "å·çƒŸåˆ†é…æœåŠ¡è¿è¡Œæ­£å¸¸",
  "timestamp": "2025-10-24T..."
}
```

---

### 3. æ£€æŸ¥æ•°æ®åº“

```bash
docker exec -it mysql mysql -usyyc -p'syyc@12AB' marketing -e "SHOW TABLES;"
```

**é¢„æœŸ**ï¼šçœ‹åˆ°åˆå§‹åŒ–çš„æ•°æ®è¡¨

---

### 4. æµè§ˆå™¨è®¿é—®å‰ç«¯

æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ï¼š

**http://10.69.110.130**

**é¢„æœŸ**ï¼šçœ‹åˆ°å·çƒŸæŠ•æ”¾ç®¡ç†ç³»ç»Ÿçš„ç•Œé¢

---

## ğŸ“‹ éƒ¨ç½²åŒ…æ£€æŸ¥æ¸…å•

åœ¨ä¸Šä¼ å‰ï¼Œè¯·ç¡®è®¤ä»¥ä¸‹æ–‡ä»¶éƒ½å­˜åœ¨ï¼š

- [x] vue-web/dist/index.html âœ… (21MB)
- [x] Springboot-server/app.jar âœ… (56MB)
- [x] mysql/init/init.sql âœ… (18KB)
- [x] deploy.sh âœ… (å¯æ‰§è¡Œ)
- [x] 8ä¸ªé…ç½®æ–‡ä»¶ âœ…

**æ€»å¤§å°**: 77MB

---

## âš™ï¸ é…ç½®ä¿¡æ¯

### æ•°æ®åº“é…ç½®

| é¡¹ç›® | å€¼ |
|-----|-----|
| æ•°æ®åº“ | marketing |
| ç”¨æˆ·å | syyc |
| å¯†ç  | syyc@12AB |
| ç±»å‹ | MySQL 8.0 |

### æœåŠ¡å™¨ä¿¡æ¯

| é¡¹ç›® | å€¼ |
|-----|-----|
| IP | 10.69.110.130 |
| SSHç«¯å£ | 50130 |
| ç”¨æˆ·å | root |
| å¯†ç  | SYyc_110.130# |

### ç«¯å£æ˜ å°„

| æœåŠ¡ | ç«¯å£ | è®¿é—®æ–¹å¼ |
|-----|------|---------|
| å‰ç«¯ | 80 | æµè§ˆå™¨è®¿é—® |
| åç«¯ | 28080 | å†…éƒ¨è®¿é—® |
| æ•°æ®åº“ | 3306 | å†…éƒ¨è®¿é—® |

---

## ğŸ” æ•…éšœæ’æŸ¥

### å¦‚æœDockeræœªå®‰è£…

```bash
# å®‰è£…Docker
curl -fsSL https://get.docker.com | sh

# å¯åŠ¨Docker
systemctl start docker
systemctl enable docker

# éªŒè¯å®‰è£…
docker --version
docker compose version

# é‡æ–°éƒ¨ç½²
cd /root/cigarette-system/data
./deploy.sh
```

---

### å¦‚æœ80ç«¯å£è¢«å ç”¨

```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep :80

# åœæ­¢å ç”¨ç«¯å£çš„æœåŠ¡
systemctl stop nginx  # æˆ–å…¶ä»–æœåŠ¡
systemctl disable nginx

# é‡æ–°éƒ¨ç½²
cd /root/cigarette-system/data
docker compose restart vue-web
```

---

### å¦‚æœå®¹å™¨å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹æ—¥å¿—
docker compose logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker compose logs mysql
docker compose logs springboot-server
docker compose logs vue-web

# é‡æ–°å¯åŠ¨
docker compose down
./deploy.sh
```

---

### å¦‚æœå‰ç«¯æ— æ³•è®¿é—®

```bash
# æ£€æŸ¥é˜²ç«å¢™
sudo ufw status
sudo ufw allow 80/tcp
sudo ufw reload

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker ps | grep vue-web

# æŸ¥çœ‹nginxæ—¥å¿—
docker compose logs vue-web
```

---

## ğŸ”§ å¸¸ç”¨ç®¡ç†å‘½ä»¤

```bash
# è¿›å…¥éƒ¨ç½²ç›®å½•
cd /root/cigarette-system/data

# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€
docker compose ps

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker compose logs -f springboot-server

# é‡å¯æ‰€æœ‰æœåŠ¡
docker compose restart

# é‡å¯ç‰¹å®šæœåŠ¡
docker compose restart springboot-server

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker compose down

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker compose up -d

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats
```

---

## ğŸ“Š æ•°æ®å¤‡ä»½

### æ•°æ®åº“å¤‡ä»½ï¼ˆå»ºè®®æ¯å¤©æ‰§è¡Œï¼‰

```bash
# æ‰‹åŠ¨å¤‡ä»½
docker exec mysql mysqldump -usyyc -p'syyc@12AB' --all-databases > /root/backup/mysql_$(date +%Y%m%d).sql

# åˆ›å»ºè‡ªåŠ¨å¤‡ä»½è„šæœ¬
cat > /root/backup-mysql.sh << 'EOF'
#!/bin/bash
BACKUP_DIR="/root/backup/mysql"
mkdir -p $BACKUP_DIR
DATE=$(date +%Y%m%d_%H%M%S)
docker exec mysql mysqldump -usyyc -p'syyc@12AB' --all-databases > $BACKUP_DIR/mysql_$DATE.sql
find $BACKUP_DIR -name "*.sql" -mtime +7 -delete
echo "Backup completed: mysql_$DATE.sql"
EOF

chmod +x /root/backup-mysql.sh

# æ·»åŠ åˆ°å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹ï¼‰
(crontab -l 2>/dev/null; echo "0 2 * * * /root/backup-mysql.sh >> /var/log/mysql-backup.log 2>&1") | crontab -
```

---

## ğŸ”„ æ›´æ–°éƒ¨ç½²

å¦‚æœéœ€è¦æ›´æ–°ç³»ç»Ÿï¼ˆæ–°çš„jaråŒ…æˆ–å‰ç«¯ä»£ç ï¼‰ï¼š

```bash
# 1. åœ¨æœ¬åœ°é‡æ–°æ„å»º
# å‰ç«¯ï¼šnpm run build
# åç«¯ï¼šmvn clean package

# 2. ä¸Šä¼ æ–°çš„éƒ¨ç½²åŒ…
scp -P 50130 -r data/ root@10.69.110.130:/root/cigarette-system/

# 3. åœ¨æœåŠ¡å™¨ä¸Šé‡æ–°éƒ¨ç½²
ssh -p 50130 root@10.69.110.130
cd /root/cigarette-system/data
docker compose down
./deploy.sh
```

**æ³¨æ„**ï¼šå¦‚æœåªæ›´æ–°ä»£ç ï¼Œæ•°æ®åº“æ•°æ®ä¼šä¿ç•™ã€‚

---

## âš ï¸ é‡è¦æé†’

### 1. é¦–æ¬¡éƒ¨ç½² vs æ›´æ–°éƒ¨ç½²

**é¦–æ¬¡éƒ¨ç½²**ï¼š
- ä¼šæ‰§è¡Œ `init.sql` åˆå§‹åŒ–æ•°æ®åº“ âœ…
- åˆ›å»ºæ‰€æœ‰è¡¨å’Œæ•°æ®

**æ›´æ–°éƒ¨ç½²**ï¼š
- å¦‚æœ `/data/mysql/data/` å·²æœ‰æ•°æ®ï¼Œ`init.sql` ä¸ä¼šé‡å¤æ‰§è¡Œ âš ï¸
- æ•°æ®åº“æ•°æ®ä¼šä¿ç•™

### 2. å®Œå…¨é‡ç½®ï¼ˆå±é™©æ“ä½œï¼‰

å¦‚éœ€å®Œå…¨é‡ç½®ç³»ç»Ÿï¼ˆåŒ…æ‹¬æ•°æ®åº“ï¼‰ï¼š

```bash
docker compose down
rm -rf /data/mysql/data/*
./deploy.sh
```

**è­¦å‘Š**: è¿™ä¼šåˆ é™¤æ‰€æœ‰æ•°æ®åº“æ•°æ®ï¼

### 3. é˜²ç«å¢™é…ç½®

ç¡®ä¿ä»¥ä¸‹ç«¯å£å·²å¼€æ”¾ï¼š

```bash
# æ£€æŸ¥é˜²ç«å¢™
sudo ufw status

# å¼€æ”¾SSHå’ŒWebç«¯å£
sudo ufw allow 50130/tcp  # SSH
sudo ufw allow 80/tcp     # Web

# å¯ç”¨é˜²ç«å¢™
sudo ufw enable
```

---

## âœ… éƒ¨ç½²æˆåŠŸæ ‡å¿—

- âœ… `docker ps` æ˜¾ç¤º3ä¸ªå®¹å™¨éƒ½æ˜¯ "Up" çŠ¶æ€
- âœ… å¥åº·æ£€æŸ¥è¿”å› `"status": "UP"`
- âœ… æµè§ˆå™¨å¯ä»¥è®¿é—® http://10.69.110.130
- âœ… å‰ç«¯é¡µé¢æ­£å¸¸æ˜¾ç¤º
- âœ… å¯ä»¥æŸ¥çœ‹æ•°æ®åº“è¡¨

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š

1. é”™è¯¯ä¿¡æ¯æˆªå›¾
2. `docker ps` è¾“å‡º
3. `docker compose logs` ç›¸å…³æ—¥å¿—
4. æ‰§è¡Œçš„å…·ä½“å‘½ä»¤

---

## ğŸ“ å®Œæ•´å‘½ä»¤æ±‡æ€»

### åœ¨æœ¬åœ°æ‰§è¡Œ

```bash
# ä¸Šä¼ éƒ¨ç½²åŒ…
cd /Users/robin/Desktop/CigaretteDistributionSystem
scp -P 50130 -r data/ root@10.69.110.130:/root/cigarette-system/
# å¯†ç : SYyc_110.130#
```

### åœ¨æœåŠ¡å™¨æ‰§è¡Œ

```bash
# è¿æ¥æœåŠ¡å™¨
ssh -p 50130 root@10.69.110.130
# å¯†ç : SYyc_110.130#

# éƒ¨ç½²
cd /root/cigarette-system/data
chmod +x deploy.sh
./deploy.sh

# éªŒè¯
docker ps
curl http://localhost:28080/api/common/health
```

### åœ¨æµè§ˆå™¨è®¿é—®

```
http://10.69.110.130
```

---

**å‡†å¤‡å°±ç»ªï¼ç°åœ¨å¯ä»¥å¼€å§‹éƒ¨ç½²äº†ï¼** ğŸš€

é¢„ç¥éƒ¨ç½²æˆåŠŸï¼

